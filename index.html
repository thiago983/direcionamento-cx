<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Direcionamento DiÃ¡rio â€“ CX</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body {
  margin: 0;
  padding: 24px;
  background: #f2f3f5;
  font-family: Arial, sans-serif;
  color: #2b2b2b;
}

h1 {
  text-align: center;
  margin-bottom: 6px;
}

.subtitle {
  text-align: center;
  font-size: 13px;
  color: #666;
  margin-bottom: 24px;
}

.container {
  display: grid;
  grid-template-columns: 1fr 3fr;
  gap: 20px;
}

/* Pessoas */
.people {
  background: #ffffff;
  border-radius: 8px;
  padding: 12px;
  border: 1px solid #d9d9d9;
}

.people-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;
}

.person {
  background: #205452;
  color: #ffffff;
  padding: 6px;
  font-size: 12px;
  border-radius: 6px;
  text-align: center;
  cursor: grab;
  user-select: none;
}

.person.fixed {
  outline: 2px solid #ffd966;
  position: relative;
}

.person.fixed::after {
  content: "ðŸ”’";
  position: absolute;
  top: -6px;
  right: -6px;
  font-size: 12px;
}

/* Escopos */
.scopes {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
}

.scope {
  background: #7caf94;
  border-radius: 8px;
  padding: 10px;
  color: #ffffff;
}

.scope h3 {
  text-align: center;
  font-size: 13px;
  margin-bottom: 8px;
}

.dropzone {
  min-height: 90px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}

/* AÃ§Ãµes */
.actions {
  margin-top: 20px;
  display: flex;
  justify-content: center;
  gap: 12px;
}

button {
  padding: 8px 16px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}

.primary {
  background: #205452;
  color: #ffffff;
}

.secondary {
  background: #dddddd;
}

.result {
  margin-top: 20px;
  background: #ffffff;
  border-radius: 8px;
  padding: 12px;
  border: 1px solid #d9d9d9;
  white-space: pre-line;
  font-size: 13px;
}
</style>
</head>

<body>

<h1>Dimensionamento DiÃ¡rio â€“ CX</h1>
<div class="subtitle">
Arraste os nomes | Duplo clique fixa ðŸ”’ | Reset mantÃ©m fixos
</div>

<div class="container">

<div class="people">
  <div class="people-grid" id="pool"></div>
</div>

<div class="scopes" id="scopes"></div>

</div>

<div class="actions">
  <button class="primary" onclick="generate()">Gerar lista</button>
  <button class="secondary" onclick="copyAll()">Copiar lista</button>
  <button class="secondary" onclick="resetAll()">Resetar</button>
</div>

<div class="result" id="result"></div>

<script>
/* ðŸ”¥ FIREBASE CONFIG */
firebase.initializeApp({
  apiKey: "AIzaSyCFRS8ALYUjtPwdMBStkBEHp9e6gwrH-fk",
  authDomain: "direcionamentocx.firebaseapp.com",
  projectId: "direcionamentocx",
  storageBucket: "direcionamentocx.firebasestorage.app",
  messagingSenderId: "545135608907",
  appId: "1:545135608907:web:c968470b718ea7053a79ce"
});

const db = firebase.firestore();
const docRef = db.collection("estado").doc("dimensionamento");

/* Dados */
const PEOPLE = [
 "Camila Marigo","Cauane Wiggberto","Elisabete Pinho","Erick Muniz",
 "Gisele Lopes","Jenifer Alcantara","JoÃ£o Finamore","Johanna Geisa","Karina Tosta",
 "Leonardo Santiago","Lorenzo Moreira","Luisa Rodrigues","Luiz Felipe Firmo","Maria Clara Periard",
 "Natanael Cruz","Rayanne Rodrigues","Samantha MarÃ§al","Jessyca Rodrigues","Rayssa MagalhÃ£es",
 "Dayane da Silva","Matheus AndrÃ©","Lais Rodrigues","Marianne Belmiro","HÃ©rica Oliveira",
 "Julia Prazeres","Wesley Freitas","Milena Cabral","Thariny Portela","Patricia Rodrigues",
 "Pedro Bento","Ana Luiza","Kelly Ribeiro","Nayara Marinho","Ana FlÃ¡via","Barbara Oliveira","Lucas Resende","Ana Luiza E."
];

const SCOPES = [
 "Manual WPP","Manual Email","Manual Chat","Social",
 "Voy","Backoffice","Reclame Aqui","FÃ©rias / LicenÃ§a / Outros"
];

const pool = document.getElementById("pool");
const scopesContainer = document.getElementById("scopes");
let dragged = null;

/* Criar escopos */
SCOPES.forEach(name => {
  const s = document.createElement("div");
  s.className = "scope";
  s.innerHTML = `
    <h3>${name}</h3>
    <div class="dropzone" ${name.includes("FÃ©rias") ? 'data-ignore="true"' : ""}></div>
  `;
  scopesContainer.appendChild(s);
});

/* Criar pessoa */
function createPerson(name, container, fixed = false) {
  const div = document.createElement("div");
  div.className = "person";
  div.textContent = name;
  div.draggable = true;

  if (fixed) div.classList.add("fixed");

  div.ondragstart = () => dragged = div;

  div.ondblclick = () => {
    div.classList.toggle("fixed");
    saveState();
  };

  container.appendChild(div);
}

/* Drag & Drop â€” CORRIGIDO */
document.addEventListener("dragover", e => e.preventDefault());
document.addEventListener("drop", e => {

  /* Soltar na base */
  if (e.target.id === "pool" || e.target.closest("#pool")) {
    pool.appendChild(dragged);
    saveState();
    return;
  }

  /* Soltar em QUALQUER PARTE do escopo */
  const scope = e.target.closest(".scope");
  if (scope) {
    const zone = scope.querySelector(".dropzone");
    if (zone) {
      zone.appendChild(dragged);
      saveState();
    }
  }
});

/* Salvar estado no Firebase */
function saveState() {
  const state = {
    pool: [...pool.children].map(p => ({
      name: p.textContent,
      fixed: p.classList.contains("fixed")
    })),
    scopes: [...document.querySelectorAll(".scope")].map(scope => ({
      name: scope.querySelector("h3").textContent,
      people: [...scope.querySelectorAll(".person")].map(p => ({
        name: p.textContent,
        fixed: p.classList.contains("fixed")
      }))
    }))
  };
  docRef.set(state);
}

/* SincronizaÃ§Ã£o realtime */
docRef.onSnapshot(doc => {
  pool.innerHTML = "";
  document.querySelectorAll(".dropzone").forEach(z => z.innerHTML = "");

  if (!doc.exists) {
    PEOPLE.forEach(p => createPerson(p, pool));
    return;
  }

  const state = doc.data();
  state.pool.forEach(p => createPerson(p.name, pool, p.fixed));
  state.scopes.forEach((s, i) => {
    const zone = document.querySelectorAll(".dropzone")[i];
    s.people.forEach(p => createPerson(p.name, zone, p.fixed));
  });
});

/* Reset */
function resetAll() {
  document.querySelectorAll(".scope").forEach(scope => {
    scope.querySelectorAll(".person").forEach(p => {
      if (!p.classList.contains("fixed")) pool.appendChild(p);
    });
  });
  saveState();
}

/* Gerar lista */
function generate() {
  let out = "";

  document.querySelectorAll(".scope").forEach(scope => {
    const zone = scope.querySelector(".dropzone");
    if (zone.dataset.ignore) return;

    const names = [...zone.children].map(p => p.textContent);
    if (!names.length) return;

    out += "â€¢ " + scope.querySelector("h3").textContent + "\n";
    names.forEach(n => out += n + "\n");
    out += "\n";
  });

  document.getElementById("result").innerHTML =
    out.replace(/- (.*)/g, "<strong>- $1</strong>");
}

/* Copiar lista */
function copyAll() {
  const result = document.getElementById("result");
  if (!result.textContent.trim()) {
    alert("Gere a lista antes de copiar ðŸ™‚");
    return;
  }

  const temp = document.createElement("textarea");
  temp.value = result.textContent;
  document.body.appendChild(temp);
  temp.select();
  document.execCommand("copy");
  document.body.removeChild(temp);

  alert("Lista copiada com sucesso!");
}
</script>

</body>
</html>




